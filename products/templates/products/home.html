{% extends "products/base.html" %}

{% block title %}
<!-- Add title here -->
{% endblock %}

<style>
  {% load static %}
  .custom-bg {
    background-image: url("{% static 'assets/img/gallery/Cloud-Lounge-Cover.png' %}") !important;
  }
  .card-span {
    height: 100%;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
  }
  .card-img-top {
    object-fit: cover;
    width: 100%;
    height: 200px;
  }
  .carousel-item {
    transition: transform 0.6s ease-in-out;
  }
  .carousel-inner .carousel-item {
    display: flex;
    flex-wrap: wrap;
  }
</style>

{% block banner %}
{% load static %}
<section class="py-5 overflow-hidden bg-primary custom-bg" id="home">
  <div class="container">
    <div class="row justify-content-center align-items-center">
      <div class="col-md-7 col-lg-6 py-8 text-md-start text-center">
          <!-- Your banner content goes here -->
      </div>
  </div>
  
  </div>
</section>
{% endblock %}


{% block body %}
{% load static %}
<!-- ============================================-->
<!-- <section> begin ============================-->
<section class="py-0">
  <div class="container">
    <div class="row h-100 gx-2 mt-7">
      <div class="col-sm-6 col-lg-3 mb-3 mb-md-0 h-100 pb-4">
        <div class="card card-span h-100">
          <div class="position-relative">
            <img class="img-fluid rounded-3 w-100"  src="{% static 'assets/img/gallery/discount-item-1.png'%}" alt="..." />
            <div class="card-actions">
              <div class="badge badge-foodwagon p-4">
                <div class="d-flex flex-between-center">
                </div>
              </div>
            </div>
          </div>
          <div class="card-body px-0 text-center">
            <h5 class="fw-bold text-1000 text-truncate">Flat Hill Slingback</h5>
            <span class="badge bg-soft-danger py-2 px-3"><span class="fs-1 text-danger">6 days Remaining</span></span>
          </div>
          <a class="stretched-link" href="#"></a>
        </div>
      </div>
      <div class="col-sm-6 col-lg-3 mb-3 mb-md-0 h-100 pb-4">
        <div class="card card-span h-100">
          <div class="position-relative">
            <img class="img-fluid rounded-3 w-100" src="{% static 'assets/img/gallery/discount-item-2.png'%}" alt="..." />
            <div class="card-actions">
              <div class="badge badge-foodwagon p-4">
                <div class="d-flex flex-between-center">
                </div>
              </div>
            </div>
          </div>
          <div class="card-body px-0 text-center">
            <h5 class="fw-bold text-1000 text-truncate">Ocean Blue Ring</h5>
            <span class="badge bg-soft-danger py-2 px-3"><span class="fs-1 text-danger">6 days Remaining</span></span>
          </div>
          <a class="stretched-link" href="#"></a>
        </div>
      </div>
      <div class="col-sm-6 col-lg-3 mb-3 mb-md-0 h-100 pb-4">
        <div class="card card-span h-100">
          <div class="position-relative">
            <img class="img-fluid rounded-3 w-100" src="{% static 'assets/img/gallery/discount-item-3.png'%}" alt="..." />
            <div class="card-actions">
              <div class="badge badge-foodwagon p-4">
                <div class="d-flex flex-between-center">
                </div>
              </div>
            </div>
          </div>
          <div class="card-body px-0 text-center">
            <h5 class="fw-bold text-1000 text-truncate">Brown Leathered Wallet</h5>
            <span class="badge bg-soft-danger py-2 px-3"><span class="fs-1 text-danger">6 days Remaining</span></span>
          </div>
          <a class="stretched-link" href="#"></a>
        </div>
      </div>
      <div class="col-sm-6 col-lg-3 mb-3 mb-md-0 h-100 pb-4">
        <div class="card card-span h-100">
          <div class="position-relative">
            <img class="img-fluid rounded-3 w-100" src="{% static 'assets/img/gallery/discount-item-4.png'%}" alt="..." />
            <div class="card-actions">
              <div class="badge badge-foodwagon p-4">
                <div class="d-flex flex-between-center">
                </div>
              </div>
            </div>
          </div>
          <div class="card-body px-0 text-center">
            <h5 class="fw-bold text-1000 text-truncate">Silverside Wristwatch</h5>
            <span class="badge bg-soft-danger py-2 px-3"><span class="fs-1 text-danger">6 days Remaining</span></span>
          </div>
          <a class="stretched-link" href="#"></a>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- <section> begin ============================-->
  <section class="py-0 overflow-hidden">
    <div class="container">
      <div class="row h-100">
        <div class="col-lg-7 mx-auto text-center mt-4 mb-5">
          <h5 class="fw-bold fs-3 fs-lg-5 lh-sm">Popular items</h5>
        </div>
        <div class="col-12">
          <div class="carousel slide" id="carouselPopularItems" data-bs-touch="false" data-bs-interval="false">
            <div class="carousel-inner">
              <div class="carousel-item active" data-bs-interval="10000">
                {% comment %} ##-------Cakes--------- {% endcomment %}
                <div class="row gx-3 h-100 align-items-center">
                  {% for cake in cakes %}
                  <div class="col-sm-6 col-md-4 col-xl mb-5 h-100">
                    <div class="card card-span h-100 rounded-3">
                      <img class="img-fluid rounded-3 card-img-top" style="height:250px !important" src="{{cake.image.url}}" alt="..." />
                      <div class="card-body ps-0 text-center">
                        <h5 class="fw-bold text-1000 text-truncate mb-1">{{cake.title}}</h5>
                        <div>
                          {% if cake.discount_price %}
                            <span class="text-muted"><del>Tk. {{cake.price}}</del></span>
                            <span class="text-danger fw-bold"> Tk. {{cake.discount_price}}</span>
                          {% else %}
                            <span class="text-1000 fw-bold">Tk. {{cake.price}}</span>
                          {% endif %}
                        </div>
                      </div>
                    </div>
                    <div class="d-grid gap-2 mt-2">
                      <button class="btn btn-lg btn-primary add-to-cart-btn" data-product-id="{{ cake.id }}">Add to Cart</button>
                      <a class="btn btn-lg btn-danger" href="{% url 'product-detail' cake.id %}" role="button">Quick View</a>
                    </div>
                  </div>
                  {% endfor %}
                </div>
  
                {% comment %} ##----Breads----- {% endcomment %}
                <div class="row gx-3 h-100 align-items-center">
                  {% for bread in breads %}
                  <div class="col-sm-6 col-md-4 col-xl mb-5 h-100">
                    <div class="card card-span h-100 rounded-3">
                      <img class="img-fluid rounded-3 card-img-top"  style="height:250px !important" src="{{bread.image.url}}" alt="..." />
                      <div class="card-body ps-0 text-center">
                        <h5 class="fw-bold text-1000 text-truncate mb-1">{{bread.title}}</h5>
                        <div>
                          {% if bread.discount_price %}
                            <span class="text-muted"><del>Tk. {{bread.price}}</del></span>
                            <span class="text-danger fw-bold"> Tk. {{bread.discount_price}}</span>
                          {% else %}
                            <span class="text-1000 fw-bold">Tk. {{bread.price}}</span>
                          {% endif %}
                        </div>
                      </div>
                    </div>
                    <div class="d-grid gap-2 mt-2">
                      <button class="btn btn-lg btn-primary add-to-cart-btn" data-product-id="{{ bread.id }}">Add to Cart</button>
                      <a class="btn btn-lg btn-danger" href="{% url 'product-detail' bread.id %}" role="button">Quick View</a>
                    </div>
                  </div>
                  {% endfor %}
                </div>
  
                {% comment %} ##-----Savory------- {% endcomment %}
                <div class="row gx-3 h-100 align-items-center">
                  {% for savorie in savories %}
                  <div class="col-sm-6 col-md-4 col-xl mb-5 h-100">
                    <div class="card card-span h-100 rounded-3">
                      <img class="img-fluid rounded-3 card-img-top" style="height:250px !important" src="{{savorie.image.url}}" alt="..." />
                      <div class="card-body ps-0 text-center">
                        <h5 class="fw-bold text-1000 text-truncate mb-1">{{savorie.title}}</h5>
                        <div>
                          {% if savorie.discount_price %}
                            <span class="text-muted"><del>Tk. {{savorie.price}}</del></span>
                            <span class="text-danger fw-bold"> Tk. {{savorie.discount_price}}</span>
                          {% else %}
                            <span class="text-1000 fw-bold">Tk. {{savorie.price}}</span>
                          {% endif %}
                        </div>
                      </div>
                    </div>
                    <div class="d-grid gap-2 mt-2">
                      <button class="btn btn-lg btn-primary add-to-cart-btn" data-product-id="{{ savorie.id }}">Add to Cart</button>
  
                      <a class="btn btn-lg btn-danger" href="{% url 'product-detail' savorie.id %}" role="button">Quick View</a>
                    </div>
                  </div>
                  {% endfor %}
                </div>
  
                {% comment %} ##-----Frozen-------- {% endcomment %}
                <div class="row gx-3 h-100 align-items-center">
                  {% for frozen in frozens %}
                  <div class="col-sm-6 col-md-4 col-xl mb-5 h-100">
                    <div class="card card-span h-100 rounded-3">
                      <img class="img-fluid rounded-3 card-img-top" style="height:250px !important" src="{{frozen.image.url}}" alt="..." />
                      <div class="card-body ps-0 text-center">
                        <h5 class="fw-bold text-1000 text-truncate mb-1">{{frozen.title}}</h5>
                        <div>
                          {% if frozen.discount_price %}
                            <span class="text-muted"><del>Tk. {{frozen.price}}</del></span>
                            <span class="text-danger fw-bold"> Tk. {{frozen.discount_price}}</span>
                          {% else %}
                            <span class="text-1000 fw-bold">Tk. {{frozen.price}}</span>
                          {% endif %}
                        </div>
                      </div>
                    </div>
                    <div class="d-grid gap-2 mt-2">
                      <button class="btn btn-lg btn-primary add-to-cart-btn" data-product-id="{{ frozen.id }}">Add to Cart</button>
                      <a class="btn btn-lg btn-danger" href="{% url 'product-detail' frozen.id %}" role="button">Quick View</a>
                    </div>
                  </div>
                  {% endfor %}
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

<!-- <section> begin ============================-->
  <section class="py-5 overflow-hidden">
    <h1 class="text-center mb-2">Food Category</h1>
    <hr>
    <div class="container">
        <div class="row flex-center mb-6">
            <div class="col-12">
                <div class="carousel slide" id="carouselSearchByFood" data-bs-touch="false" data-bs-interval="false">
                    <div class="carousel-inner">
                        <div class="carousel-item active" data-bs-interval="10000">
                            <div class="row h-100 align-items-center justify-content-center">
                                <div class="col-12 col-sm-6 col-md-3 mb-3 d-flex justify-content-center">
                                    <div class="card card-span h-100 rounded-circle" style="height: 200px; width: 200px;">
                                        <img class="img-fluid rounded-circle h-100" src="{% static 'assets/img/gallery/Cake1.png' %}" alt="Cakes" />
                                        <div class="card-body ps-0 text-center">
                                            <a class="text-center fw-bold text-1000 text-truncate mb-2" href="{% url 'cake' %}">Cakes</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-12 col-sm-6 col-md-3 mb-3 d-flex justify-content-center">
                                    <div class="card card-span h-100 rounded-circle" style="height: 200px; width: 200px;">
                                        <img class="img-fluid rounded-circle h-100" src="{% static 'assets/img/gallery/b2.png' %}" alt="Bread & Cookies" />
                                        <div class="card-body ps-0 text-center">
                                            <a class="text-center fw-bold text-1000 text-truncate mb-2" href="{% url 'bread' %}">Bread & Cookies</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-12 col-sm-6 col-md-3 mb-3 d-flex justify-content-center">
                                    <div class="card card-span h-100 rounded-circle" style="height: 200px; width: 200px;">
                                        <img class="img-fluid rounded-circle h-100" src="{% static 'assets/img/gallery/s1.png' %}" alt="Savory" />
                                        <div class="card-body ps-0 text-center">
                                            <a class="text-center fw-bold text-1000 text-truncate mb-2" href="{% url 'savory' %}">Savory</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-12 col-sm-6 col-md-3 mb-3 d-flex justify-content-center">
                                    <div class="card card-span h-100 rounded-circle" style="height: 200px; width: 200px;">
                                        <img class="img-fluid rounded-circle h-100" src="{% static 'assets/img/gallery/f2.png' %}" alt="Frozen" />
                                        <div class="card-body ps-0 text-center">
                                            <a class="text-center fw-bold text-1000 text-truncate mb-2" href="{% url 'frozen' %}">Frozen</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>  
                    </div>
                </div>
            </div>
        </div>
    </div><!-- end of .container-->
</section>

  <!-- <section> close ============================-->
  
<!-- <section> close ============================-->
 <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
  jQuery(document).ready(function($) {
    function getCookie(name) {
      let cookieValue = null;
      if (document.cookie && document.cookie !== '') {
        const cookies = document.cookie.split(';');
        for (let i = 0; i < cookies.length; i++) {
          const cookie = cookies[i].trim();
          if (cookie.substring(0, name.length + 1) === (name + '=')) {
            cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
            break;
          }
        }
      }
      return cookieValue;
    }

    $('.add-to-cart-btn').click(function(event) {
      event.preventDefault();

      var button = $(this);
      var productId = button.data('product-id');
      var csrftoken = getCookie('csrftoken');

      // Disable the button to prevent multiple clicks
      button.prop('disabled', true);

      $.ajax({
        type: 'POST',
        url: '/addtocart/' + productId + '/',
        data: {
          'product_id': productId,
          'quantity': 1
        },
        headers: {
          'X-CSRFToken': csrftoken
        },
        success: function(data) {
          console.log('Product added to cart successfully!');
          $('#navbarDropdownCart .badge').text(data.total_items);

          // Update the offcanvas cart content
          var cartOffcanvasBody = $('#cartOffcanvas .offcanvas-body');
          cartOffcanvasBody.empty();

          if (data.cart_items.length > 0) {
            data.cart_items.forEach(function(item) {
              var cartItemHtml = `
                <div class="dropdown-item cart-item">
                  <div class="d-flex justify-content-between align-items-center">
                    <div>
                      <h6 class="mb-0"><strong>${item.product.title}</strong></h6>
                      <small class="text-muted">Quantity: ${item.quantity}</small>
                    </div>
                  </div>
                </div>`;
              cartOffcanvasBody.append(cartItemHtml);
            });

            cartOffcanvasBody.append('<hr class="dropdown-divider">');
            cartOffcanvasBody.append('<a class="dropdown-item" href="{% url 'showcart' %}">View Cart <i class="fas fa-chevron-right"></i></a>');
          } else {
            cartOffcanvasBody.append('<div class="dropdown-item empty-cart">Your cart is empty</div>');
          }

          button.prop('disabled', false);  // Re-enable the button on success
        },
        error: function(xhr, textStatus, errorThrown) {
          console.log('Error:', errorThrown);
          alert('There was an error adding the product to the cart. Please try again.');
          button.prop('disabled', false);  // Re-enable the button on error
        }
      });
    });
  });
</script>


{% endblock %}
